/**
* @license RequireJS text 2.0.10 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
* Available via the MIT or new BSD license.
* see: http://github.com/requirejs/text for details
*/

(function(){if(typeof define!="function"||!define.amd)return;var e=define;define=function(){if(Object.prototype.toString.call(arguments[0])==="[object Array]")for(var t in arguments[0]){var n=require.s.contexts._.config.redefine;n[arguments[0][t]]!=undefined&&(arguments[0][t]=n[arguments[0][t]])}return e.apply(this,arguments)},define.amd=e.amd})(),require.config({baseUrl:"src",paths:{backbone:"//cdnjs.cloudflare.com/ajax/libs/backbone.js/1.1.2/backbone-min",underscore:"//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.6.0/underscore-min",jquery:"//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min",jqueryui:"//cdnjs.cloudflare.com/ajax/libs/jqueryui/1.10.4/jquery-ui.min",text:"libs/text",bootstrap:"//netdna.bootstrapcdn.com/bootstrap/3.0.2/js/bootstrap.min",cm:"//cdnjs.cloudflare.com/ajax/libs/codemirror/4.2.0",acorn:"libs/acorn"},shim:{backbone:{deps:["underscore","jquery","text"],"export":"Backbone"},underscore:{"export":"_"},bootstrap:{deps:["jquery"]},jqueryui:{deps:["jquery"]}},redefine:{"../../lib/codemirror":"cm/codemirror"}});var app=app||{};require(["tools/jarvis-ide-child","collections/cmds","views/top-panel","views/cmds-list","views/edit"],function(e,t,n,r,i){app.ide=new e,app.topPanelView=new n,app.cmds=new t,app.cmdList=new r({cmds:app.cmds}),app.editView=new i,app.ide.on("upload",function(e,t){app.editView.hide(),app.test=JSON.parse(e);var n=app.test.code_browser;app.cmds.reset(n),t({})}),app.ide.on("clear",function(e,t){app.cmds.reset([]),app.test={},t({})}),app.ide.on("get",function(e,t){app.test==undefined&&(app.test={}),app.test.code_browser=app.cmds.toJSON(),t(app.test)}),app.ide.on("add",function(e,t){app.cmds.addAction(e),t(app.test)}),app.ide.on("get-current-cmd",function(e,t){var n=app.cmds.getSelected();n!=null&&(n=n.toJSON()),t(n)}),app.ide.on("get-current-select-next",function(e,t){var n=app.cmds.getSelectedAndSelectNext();n!=null&&(n=n.toJSON()),t(n)}),app.ide.on("set-selected-at",function(e,t){app.cmds.setSelectedAt(e),t()}),app.ide.on("get-ide-size",function(e,t){var n={};n.width=$(document).width(),n.height=$(document).height(),t(n)}),$(window).on("resize",function(){app.ide.sendResize()}),app.ide.ready()}),define("app",function(){}),define("tools/jarvis-ide-message",["backbone","underscore"],function(e,t){return function(n){var r=this;this._isParent=!0,this._callbacks={},this._getWindow=function(){return r._isParent?document.querySelector("#"+r._iframeElId).contentWindow:window.parent},this.generateId=function(){return(new Date).getTime()},this.sendCallback=function(e,t){var n={name:"callback",data:t,id:e};r._getWindow().postMessage(n,"*")},this.sendMessage=function(e,t,n){var i=r.generateId(),s={name:e,data:t,id:i};n!=undefined&&(r._callbacks[i]=n),r._getWindow().postMessage(s,"*")},this.init=function(){n==undefined&&(r._isParent=!1),r._iframeElId=n,t.extend(r,e.Events),window.onmessage=function(e){if(e.data.name=="callback"){var t=e.data.id;t!=undefined&&r._callbacks[t]!=undefined&&(r._callbacks[t](e.data.data),delete r._callbacks[t]);return}r.trigger(e.data.name,e.data.data,function(t){r.sendCallback(e.data.id,t)})}},this.init()}}),define("tools/jarvis-ide-child",["tools/jarvis-ide-message"],function(e){return function(){var t=this;this.init=function(){t.postman=new e},this.on=function(){t.postman.on.apply(t.postman,arguments)},this.trigger=function(){t.postman.trigger.apply(t.postman,arguments)},this.send=function(e,n){t.postman.sendMessage(e,n)},this.sendResize=function(){var e={};e.width=$(document).width(),e.height=$(document).height(),this.send("resize",e)},this.ready=function(){t.postman.sendMessage("ready",{})},this.init()}}),define("models/cmd",["backbone"],function(e){var t=e.Model.extend({defaults:{action:"",selector:"",value:"",position:0,isSelected:!1}});return t}),define("collections/cmds",["backbone","models/cmd"],function(e,t){var n=e.Collection.extend({model:t,initialize:function(){this.listenTo(this,"reset",this.updatePositions)},addAction:function(e){if(this.length!=0){var t=this.at(this.length-1);if(t.get("command")=="type"&&e["command"]=="type"&&t.get("selector")==e["selector"]){t.set("value",e.value);return}}e.id=(new Date).getTime()+this.length,e.position=this.length,this.add(e)},comparator:function(e,t){return e=parseInt(e.get("position")),t=parseInt(t.get("position")),e>t?1:e<t?-1:0},updatePositions:function(){var e=0;this.each(function(t){t.set("isSelected",!1),t.set("position",e),e+=1},this)},setSelected:function(e){this.each(function(e){e.set("isSelected",!1)},this),this.get(e).set("isSelected",!0)},setSelectedAt:function(e){if(e>this.length-1)return;this.each(function(e){e.set("isSelected",!1)},this),this.at(e).set("isSelected",!0)},getSelected:function(){var e=this.findWhere({isSelected:!0});return e==undefined&&(e=null),e==null&&this.length>0&&(e=this.at(0),this.setSelected(e.get("id"))),e},getSelectedAndSelectNext:function(){var e=this.getSelected();if(e!=null){var t=this.indexOf(e);t!=this.length-1&&this.setSelected(this.at(t+1).get("id"))}return e}});return n}),define("text",["module"],function(e){var t,n,r,i,s,o=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],u=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,a=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,f=typeof location!="undefined"&&location.href,l=f&&location.protocol&&location.protocol.replace(/\:/,""),c=f&&location.hostname,h=f&&(location.port||undefined),p={},d=e.config&&e.config()||{};t={version:"2.0.10",strip:function(e){if(e){e=e.replace(u,"");var t=e.match(a);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:d.createXhr||function(){var e,t,n;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(t=0;t<3;t+=1){n=o[t];try{e=new ActiveXObject(n)}catch(r){}if(e){o=[n];break}}return e},parseName:function(e){var t,n,r,i=!1,s=e.indexOf("."),o=e.indexOf("./")===0||e.indexOf("../")===0;return s!==-1&&(!o||s>1)?(t=e.substring(0,s),n=e.substring(s+1,e.length)):t=e,r=n||t,s=r.indexOf("!"),s!==-1&&(i=r.substring(s+1)==="strip",r=r.substring(0,s),n?n=r:t=r),{moduleName:t,ext:n,strip:i}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,r,i){var s,o,u,a=t.xdRegExp.exec(e);return a?(s=a[2],o=a[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===n)&&(!o||o.toLowerCase()===r.toLowerCase())&&(!u&&!o||u===i)):!0},finishLoad:function(e,n,r,i){r=n?t.strip(r):r,d.isBuild&&(p[e]=r),i(r)},load:function(e,n,r,i){if(i.isBuild&&!i.inlineText){r();return}d.isBuild=i.isBuild;var s=t.parseName(e),o=s.moduleName+(s.ext?"."+s.ext:""),u=n.toUrl(o),a=d.useXhr||t.useXhr;if(u.indexOf("empty:")===0){r();return}!f||a(u,l,c,h)?t.get(u,function(n){t.finishLoad(e,s.strip,n,r)},function(e){r.error&&r.error(e)}):n([o],function(e){t.finishLoad(s.moduleName+"."+s.ext,s.strip,e,r)})},write:function(e,n,r,i){if(p.hasOwnProperty(n)){var s=t.jsEscape(p[n]);r.asModule(e+"!"+n,"define(function () { return '"+s+"';});\n")}},writeFile:function(e,n,r,i,s){var o=t.parseName(n),u=o.ext?"."+o.ext:"",a=o.moduleName+u,f=r.toUrl(o.moduleName+u)+".js";t.load(a,r,function(n){var r=function(e){return i(f,e)};r.asModule=function(e,t){return i.asModule(e,f,t)},t.write(e,a,r,s)},s)}};if(d.env==="node"||!d.env&&typeof process!="undefined"&&process.versions&&!!process.versions.node&&!process.versions["node-webkit"])n=require.nodeRequire("fs"),t.get=function(e,t,r){try{var i=n.readFileSync(e,"utf8");i.indexOf("ï»¿")===0&&(i=i.substring(1)),t(i)}catch(s){r(s)}};else if(d.env==="xhr"||!d.env&&t.createXhr())t.get=function(e,n,r,i){var s=t.createXhr(),o;s.open("GET",e,!0);if(i)for(o in i)i.hasOwnProperty(o)&&s.setRequestHeader(o.toLowerCase(),i[o]);d.onXhr&&d.onXhr(s,e),s.onreadystatechange=function(t){var i,o;s.readyState===4&&(i=s.status,i>399&&i<600?(o=new Error(e+" HTTP status: "+i),o.xhr=s,r(o)):n(s.responseText),d.onXhrComplete&&d.onXhrComplete(s,e))},s.send(null)};else if(d.env==="rhino"||!d.env&&typeof Packages!="undefined"&&typeof java!="undefined")t.get=function(e,t){var n,r,i="utf-8",s=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),u=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),i)),a="";try{n=new java.lang.StringBuffer,r=u.readLine(),r&&r.length()&&r.charAt(0)===65279&&(r=r.substring(1)),r!==null&&n.append(r);while((r=u.readLine())!==null)n.append(o),n.append(r);a=String(n.toString())}finally{u.close()}t(a)};else if(d.env==="xpconnect"||!d.env&&typeof Components!="undefined"&&Components.classes&&Components.interfaces)r=Components.classes,i=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),s="@mozilla.org/windows-registry-key;1"in r,t.get=function(e,t){var n,o,u,a={};s&&(e=e.replace(/\//g,"\\")),u=new FileUtils.File(e);try{n=r["@mozilla.org/network/file-input-stream;1"].createInstance(i.nsIFileInputStream),n.init(u,1,0,!1),o=r["@mozilla.org/intl/converter-input-stream;1"].createInstance(i.nsIConverterInputStream),o.init(n,"utf-8",n.available(),i.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),o.readString(n.available(),a),o.close(),n.close(),t(a.value)}catch(f){throw new Error((u&&u.path||"")+": "+f)}};return t}),define("text!templates/top-panel.html",[],function(){return'<span data-eid="ide-version">Jarvis Editor: v. 0.4.5</span>\n<button data-eid="add-command" class="btn btn-success pull-right"><i class="fa fa-plus"></i></button>'}),define("views/top-panel",["backbone","text!templates/top-panel.html"],function(e,t){var n=e.View.extend({el:"#top-panel",template:_.template(t),events:{"click [data-eid=add-command]":"addCommand"},initialize:function(){this.render()},render:function(){this.$el.html(this.template())},addCommand:function(){app.editView.setModel(),app.editView.show()}});return n}),define("text!templates/cmd.html",[],function(){return'<div data-type="command">\n    <div class=\'dragger\'><i class="fa fa-bars"></i></div>\n    <div class=\'command-body\' data-model-id=\'<%= data["id"] %>\'>\n        <div class=\'command-property\'>\n            <a target="_blank" href="https://jarvisjs.hackpad.com/Jarvis-IDE-Actions-zGBA8oe0neF"><%= data["command"] %></a>\n            <div data-type="command-buttons" class="pull-right"><!--i data-type="play" class="fa fa-play"></i--><i data-type="remove" class="fa fa-times"></i></div>\n        </div>\n        <% if ( data["command"] == "change" || data["command"] == "type" ) { %>            \n            <div class=\'command-property\'><%= data["value"] %></div>\n        <% } else if ( data["command"] == "assertEval" ) { %>\n            <div class=\'command-property\'><%= data["name"] %></div>\n        <% } else { %>\n            <div class=\'command-property\'><%= data["selector"] %></div>\n        <% } %>\n        <!--div class=\'command-property\'><%= data["value"] %></div-->\n    </div>\n</div>'}),define("views/cmd",["backbone","underscore","text!templates/cmd.html"],function(e,t,n){var r=e.View.extend({tagName:"li",className:"ui-state-default",template:t.template(n),events:{"click .command-body":"select","click [data-type=remove]":"remove","click [data-type=play]":"play"},initialize:function(){},render:function(){return this.$el.html(this.template({data:this.model.toJSON()})),this.model.get("isSelected")&&this.$el.addClass("command-selected"),this},play:function(){return app.ide.send("play",this.model.toJSON()),!1},remove:function(){return this.model.trigger("remove-model",this.model),!1},showEdit:function(){app.cmdList.$el.hide(),app.editView.setModel(this.model),app.editView.show()},select:function(){this.model.get("isSelected")?this.showEdit():app.cmds.setSelected(this.model.get("id"))}});return r}),define("views/cmds-list",["backbone","views/cmd","jqueryui"],function(e,t){var n=e.View.extend({el:"#cmds-list",events:{click:"clickEvent","mouseenter [data-type=command]":"enterCommand","mouseleave  [data-type=command]":"leaveCommand"},initialize:function(e){var t=this;this.cmds=e.cmds,this.listenTo(this.cmds,"change reset remove sort",this.render),this.listenTo(this.cmds,"remove-model",this.removeModel),this.render()},clickEvent:function(){this.trigger("click:view")},render:function(){this.$el.empty(),this.cmds.each(function(e){var n=new t({model:e});this.$el.append(n.render().$el)},this),this.enableDrag()},enableDrag:function(){var e=this;this.$el.sortable({placeholder:"ui-state-highlight",handle:".dragger",stop:function(t,n){e.reOrderCollection()}}),this.$el.disableSelection()},removeModel:function(e){this.leaveCommandById(e.get("id")),console.log("Remove",e),this.cmds.remove(e)},reOrderCollection:function(){var e=this,t=0;this.$("[data-model-id]").each(function(){var n=$(this).attr("data-model-id"),r=e.cmds.get(n);r.set("position",t),t+=1}),this.cmds.sort()},enterCommand:function(e){$(e.currentTarget).parent().addClass("command-hover");var t=$(e.currentTarget).find("[data-model-id]").attr("data-model-id"),n=this.cmds.get(t),r=n.toJSON();app.ide.send("enter",r)},leaveCommand:function(e){$(e.currentTarget).parent().removeClass("command-hover");var t=$(e.currentTarget).find("[data-model-id]").attr("data-model-id");this.leaveCommandById(t)},leaveCommandById:function(e){var t=this.cmds.get(e),n=t.toJSON();app.ide.send("leave",n)}});return n}),define("text!templates/actions/empty.html",[],function(){return""}),define("views/actions/empty",["backbone","underscore","text!templates/actions/empty.html"],function(e,t,n){var r=e.View.extend({template:t.template(n),events:{},initialize:function(){},render:function(){return this.$el.html(this.template()),this},getValues:function(){return{}}});return r}),define("text!templates/fields/selector.html",[],function(){return'<div class="row">\n    <div class="form-group col-md-12">\n        <% if ( data["iframepath"] == undefined || data["iframepath"].length == 0 ) { %>\n        <label>Selector</label>\n        <% } else { %>\n        <label>Selector (iframe)</label>\n        <% } %>\n        <input data-eid="selector" class="form-control" value="<%= _.escape(data[\'selector\']) %>" />\n    </div>\n</div>'}),define("views/fields/selector",["backbone","underscore","text!templates/fields/selector.html"],function(e,t,n){var r=e.View.extend({template:t.template(n),events:{},initialize:function(){this.render()},render:function(){return this.$el.html(this.template({data:this.model.toJSON()})),this},getValue:function(){return this.$("[data-eid=selector]").val()}});return r}),define("text!templates/fields/js-editor.html",[],function(){return'<br/>\n<div class="row">\n    <div class="form-group col-md-12">\n        <div data-eid="error" style="display: none;" class="alert alert-danger"></div>\n    </div>\n</div>\n\n<div class="row">    \n    <div class="form-group col-md-12">\n        <label>JavaScript code (F11 - fullscreen)</label>\n		<textarea data-eid="codemirror" cols="30" rows="10"><%= _.escape( data[\'value\'] ) %></%></textarea>\n    </div>\n</div>'}),define("views/fields/js-editor",["backbone","underscore","cm/codemirror","acorn","text!templates/fields/js-editor.html","cm/mode/javascript/javascript","cm/addon/edit/matchbrackets","cm/addon/edit/closebrackets","cm/addon/display/fullscreen"],function(e,t,n,r,i){var s=e.View.extend({template:t.template(i),events:{},initialize:function(){},render:function(){return this.$el.html(this.template({data:this.model.toJSON()})),this},init:function(){this.initCodemirror(this.model.get("value"))},initCodemirror:function(e){e+="",e==undefined&&(e="");var t=this;this.codeMirror=n(function(e){t.$el.find("[data-eid=codemirror]")[0].parentNode.replaceChild(e,t.$el.find("[data-eid=codemirror]")[0])},{value:e,lineNumbers:!0,matchBrackets:!0,autoCloseBrackets:!0,extraKeys:{"Ctrl-Space":"autocomplete",F11:function(e){e.setOption("fullScreen",!e.getOption("fullScreen"))},Esc:function(e){e.getOption("fullScreen")&&e.setOption("fullScreen",!1)}}}),e!=""&&this.codeMirror.setValue(e)},validate:function(e){var t=null;try{var n=r.parse(e,{forbidReserved:!0,allowReturnOutsideFunction:!0})}catch(i){t=i.message}return t},getValue:function(){var e=this.codeMirror.getValue(),t=this.validate(e);return t!=null?(this.$('[data-eid="error"]').text(t),this.$('[data-eid="error"]').show(),!1):(this.$('[data-eid="error"]').hide(),e)}});return s}),define("text!templates/fields/value.html",[],function(){return'<div class="row">\n    <div class="form-group col-md-12">\n        <label>Value</label>\n        \n        <ul id="myTab" class="nav nav-tabs">\n            <% if ( data["valueType"] != "eval" ) { %>\n                <li class="active"><a href="[data-eid=plain-value-tab]" data-value-type="plain" data-toggle="tab">Plain</a></li>            \n                <li><a href="[data-eid=eval-value-tab]" data-value-type="eval" data-toggle="tab">Eval</a></li>            \n            <% } else { %>\n                <li><a href="[data-eid=plain-value-tab]" data-value-type="plain" data-toggle="tab">Plain</a></li>            \n                <li class="active"><a href="[data-eid=eval-value-tab]" data-value-type="eval" data-toggle="tab">Eval</a></li>            \n            <% } %>\n        </ul>\n\n        <div class="tab-content">\n            <% if ( data["valueType"] != "eval" ) { %>\n            <div class="tab-pane active" data-eid="plain-value-tab">\n            <% } else { %>\n            <div class="tab-pane" data-eid="plain-value-tab">\n            <% } %>\n                <br/>\n                <input data-eid="value" type="text" class="form-control" value="<%= _.escape( data[\'value\'] ) %>">\n                \n            </div>\n\n            <% if ( data["valueType"] != "eval" ) { %>\n            <br/>\n            <div class="tab-pane" data-eid="eval-value-tab">\n            <% } else { %>\n            <div class="tab-pane active" data-eid="eval-value-tab">\n            <% } %>            \n                \n            </div>            \n        </div>       \n        \n    </div>\n</div>'}),define("views/fields/value",["backbone","underscore","views/fields/js-editor","text!templates/fields/value.html"],function(e,t,n,r){var i=e.View.extend({template:t.template(r),events:{"click [data-toggle=tab]":"changeValueType"},initialize:function(){this.render()},changeValueType:function(e){var t=this.$(e.target).attr("data-value-type");this.model.set("valueType",t)},render:function(){return this.$el.html(this.template({data:this.model.toJSON()})),this.jsEditorView=new n({model:this.model}),this.$('[data-eid="eval-value-tab"]').append(this.jsEditorView.render().$el),this},init:function(){this.jsEditorView.init()},getValues:function(){var e=this.model.get("value"),t=this.model.get("postfix"),n=this.model.get("prefix");if(this.model.get("valueType")=="eval"){e=this.jsEditorView.getValue();if(e===!1)return!1}else e=this.$("[data-eid=value]").val();return{value:e,postfix:t,prefix:n}}});return i}),define("text!templates/actions/base.html",[],function(){return""}),define("views/actions/base",["backbone","underscore","views/fields/selector","views/fields/value","text!templates/actions/base.html"],function(e,t,n,r,i){var s=e.View.extend({template:t.template(i),events:{},initialize:function(){},render:function(){return this.$el.html(this.template({data:this.model.toJSON()})),this.selectorView=new n({model:this.model}),this.$el.append(this.selectorView.render().$el),this.valueView=new r({model:this.model}),this.$el.append(this.valueView.render().$el),this},init:function(){this.valueView.init()},getValues:function(){var e=this.selectorView.getValue(),t=this.valueView.getValues();return t===!1?!1:(t.selector=e,t)}});return s}),define("text!templates/actions/selector-only.html",[],function(){return""}),define("views/actions/selector-only",["backbone","underscore","views/fields/selector","text!templates/actions/selector-only.html"],function(e,t,n,r){var i=Backbone.View.extend({template:t.template(r),events:{},initialize:function(){},render:function(){return this.$el.html(this.template({data:this.model.toJSON()})),this.selectorView=new n({model:this.model}),this.$el.append(this.selectorView.render().$el),this},init:function(){},getValues:function(){var e={},t=this.selectorView.getValue();return e.selector=t,e}});return i}),define("text!templates/fields/value-plain.html",[],function(){return'<div class="row">\n    <div class="form-group col-md-12">\n        <label>Value</label>\n        <input data-eid="value" type="text" class="form-control" value="<%= _.escape( data[\'value\'] ) %>">\n    </div>\n</div>'}),define("views/fields/value-plain",["backbone","underscore","views/fields/js-editor","text!templates/fields/value-plain.html"],function(e,t,n,r){var i=e.View.extend({template:t.template(r),initialize:function(){this.render()},render:function(){return this.$el.html(this.template({data:this.model.toJSON()})),this},init:function(){},getValues:function(){var e=this.model.get("value");return e=this.$("[data-eid=value]").val(),{value:e,postfix:"",prefix:""}}});return i}),define("views/actions/selector-plain-value",["backbone","underscore","views/fields/selector","views/fields/value-plain","text!templates/actions/base.html"],function(e,t,n,r,i){var s=e.View.extend({template:t.template(i),events:{},initialize:function(){},render:function(){return this.$el.html(this.template({data:this.model.toJSON()})),this.selectorView=new n({model:this.model}),this.$el.append(this.selectorView.render().$el),this.valueView=new r({model:this.model}),this.$el.append(this.valueView.render().$el),this},init:function(){},getValues:function(){var e=this.selectorView.getValue(),t=this.valueView.getValues();return t===!1?!1:(t.selector=e,t)}});return s}),define("text!templates/actions/value-only.html",[],function(){return""}),define("views/actions/value-only",["backbone","underscore","views/fields/value","text!templates/actions/value-only.html"],function(e,t,n,r){var i=Backbone.View.extend({template:t.template(r),events:{},initialize:function(){},render:function(){return this.$el.html(this.template({data:this.model.toJSON()})),this.valueView=new n({model:this.model}),this.$el.append(this.valueView.render().$el),this},init:function(){this.valueView.init()},getValues:function(){var e=this.valueView.getValues();return e===!1?!1:e}});return i}),define("text!templates/actions/value-plain.html",[],function(){return""}),define("views/actions/value-plain",["backbone","underscore","views/fields/value-plain","text!templates/actions/value-plain.html"],function(e,t,n,r){var i=Backbone.View.extend({template:t.template(r),events:{},initialize:function(){},render:function(){return this.$el.html(this.template({data:this.model.toJSON()})),this.valueView=new n({model:this.model}),this.$el.append(this.valueView.render().$el),this},init:function(){this.valueView.init()},getValues:function(){var e=this.valueView.getValues();return e===!1?!1:e}});return i}),define("text!templates/fields/value-code-only.html",[],function(){return'<div class="row">\n    <div class="form-group col-md-12">\n        <label>Value</label>        \n            \n        <div data-eid="eval-value-tab"></div>                    \n    </div>\n</div>'}),define("views/fields/value-code-only",["backbone","underscore","views/fields/js-editor","text!templates/fields/value-code-only.html"],function(e,t,n,r){var i=e.View.extend({template:t.template(r),events:{"click [data-toggle=tab]":"changeValueType"},initialize:function(){this.render()},render:function(){return this.$el.html(this.template({data:this.model.toJSON()})),this.jsEditorView=new n({model:this.model}),this.$('[data-eid="eval-value-tab"]').append(this.jsEditorView.render().$el),this},init:function(){this.jsEditorView.init()},getValues:function(){var e=e=this.jsEditorView.getValue();return e===!1?!1:{value:e}}});return i}),define("views/actions/value-code-only",["backbone","underscore","views/fields/value-code-only","text!templates/actions/value-only.html"],function(e,t,n,r){var i=Backbone.View.extend({template:t.template(r),events:{},initialize:function(){},render:function(){return this.$el.html(this.template({data:this.model.toJSON()})),this.valueView=new n({model:this.model}),this.$el.append(this.valueView.render().$el),this},init:function(){this.valueView.init()},getValues:function(){var e=this.valueView.getValues();return e===!1?!1:e}});return i}),define("text!templates/actions/assert-eval.html",[],function(){return'<div class="row">\n    <div class="form-group col-md-12">\n        <label>Assert name</label>\n        <input data-eid="assert-name" class="form-control" value="<%= data[\'name\'] %>" />\n    </div>\n</div>\n\n<div data-eid="js-code-field"></div>'}),define("views/actions/assert-eval",["backbone","underscore","views/fields/js-editor","text!templates/actions/assert-eval.html"],function(e,t,n,r){var i=e.View.extend({template:t.template(r),events:{},initialize:function(){},render:function(){return this.$el.html(this.template({data:this.model.toJSON()})),this.jsEditorView=new n({model:this.model}),this.$('[data-eid="js-code-field"]').append(this.jsEditorView.render().$el),this},init:function(){this.jsEditorView.init()},getValues:function(){var e=this.jsEditorView.getValue();if(e===!1)return!1;var t=this,n={value:e,name:t.$("[data-eid=assert-name]").val()};return n}});return i}),define("text!templates/edit.html",[],function(){return'<div id="edit-top-panel">\n    <button data-type="hide" class="btn btn-default pull-right"><i class="fa fa-times"></i></button>\n</div>\n<br/><br/>\n<div class="row">\n    <div class="form-group col-md-12">\n        <label>Action</label>\n        <select data-eid="actions-list" class="form-control">\n            <option value=""           > </option>\n            <option value="click"      >click</option>\n            <option value="dblclick"   >double click</option>\n            <option value="mousedown"  >mousedown</option>\n            <option value="mouseup"    >mouseup</option>\n            <option value="type"       >type</option>\n            <option value="change"     >change</option>                        \n            <option value="open"       >open</option>\n            <option value="wait"       >wait</option>\n            <option value="waitForSelector">waitForSelector</option>\n            <option value="waitFor"    >waitFor</option>\n            <option value="sendKeys"   >sendKeys</option>            \n            <option value="reload"     >reload page</option>\n            <option value="assertEval" >assertEval</option>\n            <option value="assertTitle">assertTitle</option>\n            <option value="assertCount">assertCount</option>\n        </select>        \n    </div>\n</div>\n\n<div class="row">\n    <div class="form-group col-md-12" style="display:none;">\n        <label>Raw action (custom action name)</label>\n        <input data-eid="raw-action" class="form-control" value="<%= data[\'command\'] %>" />\n    </div>\n</div>\n\n<div data-eid="action-properties"></div>\n\n<div class="row">\n    <div class="form-group col-md-12">\n        <% if ( data["id"] != undefined ) { %>\n        <button data-eid="update-command" class="btn btn-default">Update</button>\n        <% } else { %>\n        <button data-eid="add-command" class="btn btn-default">Add</button>\n        <% } %>\n    </div>    \n</div>'}),define("views/edit",["backbone","underscore","views/actions/empty","views/actions/base","views/actions/selector-only","views/actions/selector-plain-value","views/actions/value-only","views/actions/value-plain","views/actions/value-code-only","views/actions/assert-eval","models/cmd","text!templates/edit.html","bootstrap"],function(e,t,n,r,i,s,o,u,a,f,l,c){var h=e.View.extend({el:"#edit-view",template:t.template(c),model:new l,events:{click:"clickEvent","click [data-type=hide]":"hide","click [data-eid=add-command]":"addCommand","click [data-eid=update-command]":"updateCommand","change [data-eid=actions-list]":"changeCommand"},initialize:function(){this.listenTo(this.model,"change",this.render),this.render()},clickEvent:function(){this.trigger("click:view")},actionsMap:{click:i,dblclick:i,mouseup:i,mousedown:i,screenshot:i,open:o,sendKeys:o,wait:u,waitFor:a,waitForSelector:i,reload:u,assertTitle:o,assertEval:f,assertCount:s},getViewByName:function(e){return e==undefined?n:e in this.actionsMap?this.actionsMap[e]:r},render:function(){this.$el.html(this.template({data:this.model.toJSON()})),this.$("[data-eid=actions-list]").val(this.model.get("action")||this.model.get("command"));var e=this.model.get("command");this.view=new(this.getViewByName(e))({model:this.model}),this.$("[data-eid=action-properties]").append(this.view.render().$el),this.view.init!=undefined&&this.view.init(),app.ide.sendResize()},changeCommand:function(e){var t=$(e.currentTarget).val();$('[data-eid="raw-action"]').val(""),this.model.set({command:t}),this.render()},grub:function(){var e=this.view.getValues();return e===!1?!1:(e.command=$('[data-eid="raw-action"]').val()||self.$("[data-eid=actions-list]").val(),this.model.set(e),!0)},updateCommand:function(){this.grub()&&(this.originModel.set(this.model.toJSON()),this.hide())},addCommand:function(){this.grub()&&(app.cmds.addAction(this.model.toJSON()),this.hide())},setModel:function(e){e==undefined?e=new l:this.originModel=e,this.model!=undefined&&this.stopListening(this.model),this.model=new l(e.toJSON()),this.listenTo(this.model,"change",this.render),this.render()},show:function(){this.$el.show(),this.render()},hide:function(){this.$el.hide(),app.cmdList.$el.show(),app.ide.sendResize()},isVisible:function(){return this.$el.is(":visible")}});return h});