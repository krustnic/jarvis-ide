<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <title></title>
    <script src="//cdnjs.cloudflare.com/ajax/libs/require.js/2.1.11/require.min.js"></script>
    <script>
    
        require.config({    
            //urlArgs: "bust=" + (new Date()).getTime(),
            baseUrl: "src",
            paths: {
                "backbone"   : "//cdnjs.cloudflare.com/ajax/libs/backbone.js/1.1.2/backbone-min",
                "underscore" : "//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.6.0/underscore-min",
                "jquery"     : "//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min"
            },
            shim : {
                "backbone" : {
                    deps : [ "underscore", "jquery" ],
                    export : "_"
                }
            }
        });
        
        var TEST_JSON = '{"id":"324","testId":"339","name":"S7 test 222","description":"","width":"1280","height":"1024","isPure":"0","codeBrowser":[{"command":"open","selector":"","value":"http://www.s7.ru/","context":"http://www.s7.ru/","id":"0"},{"command":"click","selector":"div header > div > div > div:nth-of-type(2) > div > form > div > button","value":"","context":"http://www.s7.ru/","id":"8"},{"command":"assertEval","selector":"","value":"return text() == Неверный логин/пароль","context":"","name":"Check auth error","id":"9"}],"codeCasper":"","versionDate":"2014-05-21 11:19:52","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/34.0.1847.131 Safari/537.36"}';
        
        
        function init() {
            require( ["tools/jarvis-ide-parent", "jquery"], function( JParent, $ ) {
                var jparent = new JParent();
                
                jparent.on("ready", function( msg ) {
                    console.log("IFrame ready!", msg);                    
                });
                
                $("#ide-open").click( function() {
                    jparent.uploadTest( TEST_JSON );
                } );

                $("#ide-clear").click( function() {
                    jparent.send("clear");
                    /*
                    jparent.clearTest( function() {
                        
                    } );                    
                    */
                } );
                
                $("#ide-get").click( function() {
                    jparent.getTest( function( test ) {
                        console.log("GET TEST: ", test );
                    } );                    
                } );
                
                $("#ide-add").click( function() {
                    var action = {
                        command : "click",
                        selector : "div",
                        value : ""                        
                    }
                    
                    jparent.send( "add", action );                    
                } );
            });
        }
        
    </script>
</head>
<body>
    <div style="background-color: rgb(179, 194, 255);padding: 7px;">
        <button id="ide-open">open</button>
        <button id="ide-clear">clear</button>
        <button id="ide-get">get</button>
        <button id="ide-add">add</button>
        <div style="float:right">Parent page</div>
    </div>
    <br/>
    
    <div style="height:800px">
        <iframe id="jarvis-ide" onload="init();" style="width:100%;height:100%" src="ide.html" frameborder="0"></iframe>
    </div>    
</body>
</html>















